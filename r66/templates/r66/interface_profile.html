{% extends "r66/base.html" %}
{% load i18n %}
{% load r66_extras %}
{% load sekizai_tags %}


        {% block sidebar %}
			  <div class="span3">
					<div id="div-sidebar-nav" class="well sidebar-nav" > 
						<ul class="nav nav-list">
						</ul>
					</div><!--/.well -->
        </div><!--/span-->
        {% endblock sidebar %}


          {% block content %}
            {% block object-tools %}
            {% endblock %}
						{{ content }}

    <div id="div-form" class="span6">
			{{ netiface_profile_form.as_p }}
			{{ net_settings_form.as_p }}
			{{ wifi_settings_form.as_p }}
			{{ dhcpd_settings_form.as_p }}
    </div>


{% addtoblock "js" %}
<script type="text/javascript">

	{% if selected_profile %}
  	var selected_profile = {{ selected_profile }};
  {% else %}
	  var selected_profile = undefined;
  {% endif %}
																																		
	function get_netiface_profiles_js_callback(data){

		var items = new Array();
		$.each(data, function(key_profile, profile) {
      if ( items[profile["fields"]["netiface"]] == undefined )
			{
			  items[profile["fields"]["netiface"]] = [];
			}
			var active = "";
			if  (selected_profile == profile["pk"] )
			{
			  active = 'class="active"';
			}

      items[profile["fields"]["netiface"]].push(
				'<li ' + active + '>'
  				+ '<a href="{% url r66-interfaces  %}' + profile["pk"] + '">'
					+ profile["pk"] 
					+ '</a>'
					+ '</li>'
      );
    });
		
		for(var key in items){
			var li_items = items[key].join('\n');
		  $("#nav-li-" + key).replaceWith(li_items);
		}

  }


	function get_netifaces_js_callback(data){

    var nav_header_items = [];

		$.each(data, function(key_iface, iface) {

      nav_header_items.push(
					'<li id="nav-header-' + iface["pk"] + '" class="nav-header">' 
					+ iface["fields"]["name"] + '</li>' 
					+ ' <li id="nav-li-' + iface["pk"] + '"> ' 
					+ ' <a href="#"> ... </a></li>'
					+ ' <li> ' 
					+ ' <a href="#"> Add profile </a></li>'

				);

    });

		var ul = $('<ul class="nav nav-list"> ' + nav_header_items.join('\n') + ' </ul>');

		$("#div-sidebar-nav").replaceWith('<div id="div-sidebar-nav" class="well sidebar-nav" >');
    ul.appendTo('#div-sidebar-nav');

    Dajaxice.r66.get_netiface_profiles(get_netiface_profiles_js_callback);

  }


  $( function() {

	  Dajaxice.r66.get_netifaces(get_netifaces_js_callback);

		Dajaxice.r66.get_netiface_profile_settings(get_netiface_profile_js_callback, 
			{'id':selected_profile});

  });

</script>
{% endaddtoblock %}




          {% endblock %}


